"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LangchainAgentStack = void 0;
exports.createLangchainAgentStack = createLangchainAgentStack;
const aws_cdk_lib_1 = require("aws-cdk-lib");
const langchain_agent_js_1 = require("../constructs/langchain-agent.js");
/**
 * Stack wrapper for the LangchainAgent construct
 * Provides a complete deployment unit for the agent
 */
class LangchainAgentStack extends aws_cdk_lib_1.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        // Create the LangchainAgent construct
        this.agent = new langchain_agent_js_1.LangchainAgent(this, 'LangchainAgent', props.agentProps);
        // Add stack-level tags
        this.addStackTags();
    }
    /**
     * Add common tags to the stack
     */
    addStackTags() {
        this.tags.setTag('Project', 'KxGen');
        this.tags.setTag('Component', 'LangchainAgent');
        this.tags.setTag('ManagedBy', 'CDK');
    }
}
exports.LangchainAgentStack = LangchainAgentStack;
/**
 * Helper function to create a complete LangchainAgent stack
 */
function createLangchainAgentStack(scope, id, props) {
    return new LangchainAgentStack(scope, id, {
        env: props.env,
        agentProps: {
            eventBus: props.eventBusArn,
            existingTables: props.messagesTableName && props.leadsTableName ? {
                messagesTableName: props.messagesTableName,
                leadsTableName: props.leadsTableName,
            } : undefined,
            bedrockModelId: props.bedrockModelId || 'anthropic.claude-3-sonnet-20240229-v1:0',
            opensearchCollectionArn: props.opensearchCollectionArn,
            putEventsRoleArn: props.putEventsRoleArn,
        },
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZ2NoYWluLWFnZW50LXN0YWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3N0YWNrcy9sYW5nY2hhaW4tYWdlbnQtc3RhY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBK0NBLDhEQTZCQztBQTNFRCw2Q0FBZ0Q7QUFFaEQseUVBQXVGO0FBY3ZGOzs7R0FHRztBQUNILE1BQWEsbUJBQW9CLFNBQVEsbUJBQUs7SUFHNUMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUErQjtRQUN2RSxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixzQ0FBc0M7UUFDdEMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLG1DQUFjLENBQUMsSUFBSSxFQUFFLGdCQUFnQixFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUUxRSx1QkFBdUI7UUFDdkIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3RCLENBQUM7SUFFRDs7T0FFRztJQUNLLFlBQVk7UUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ2hELElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQztJQUN2QyxDQUFDO0NBQ0Y7QUFyQkQsa0RBcUJDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQix5QkFBeUIsQ0FDdkMsS0FBZ0IsRUFDaEIsRUFBVSxFQUNWLEtBV0M7SUFFRCxPQUFPLElBQUksbUJBQW1CLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRTtRQUN4QyxHQUFHLEVBQUUsS0FBSyxDQUFDLEdBQUc7UUFDZCxVQUFVLEVBQUU7WUFDVixRQUFRLEVBQUUsS0FBSyxDQUFDLFdBQVc7WUFDM0IsY0FBYyxFQUFFLEtBQUssQ0FBQyxpQkFBaUIsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztnQkFDaEUsaUJBQWlCLEVBQUUsS0FBSyxDQUFDLGlCQUFpQjtnQkFDMUMsY0FBYyxFQUFFLEtBQUssQ0FBQyxjQUFjO2FBQ3JDLENBQUMsQ0FBQyxDQUFDLFNBQVM7WUFDYixjQUFjLEVBQUUsS0FBSyxDQUFDLGNBQWMsSUFBSSx5Q0FBeUM7WUFDakYsdUJBQXVCLEVBQUUsS0FBSyxDQUFDLHVCQUF1QjtZQUN0RCxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsZ0JBQWdCO1NBQ3pDO0tBQ0YsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0IHsgU3RhY2ssIFN0YWNrUHJvcHMgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnYXdzLWNkay1saWIvYXdzLWV2ZW50cyc7XG5pbXBvcnQgeyBMYW5nY2hhaW5BZ2VudCwgTGFuZ2NoYWluQWdlbnRQcm9wcyB9IGZyb20gJy4uL2NvbnN0cnVjdHMvbGFuZ2NoYWluLWFnZW50LmpzJztcblxuZXhwb3J0IGludGVyZmFjZSBMYW5nY2hhaW5BZ2VudFN0YWNrUHJvcHMgZXh0ZW5kcyBTdGFja1Byb3BzIHtcbiAgLyoqXG4gICAqIFByb3BlcnRpZXMgZm9yIHRoZSBMYW5nY2hhaW5BZ2VudCBjb25zdHJ1Y3RcbiAgICovXG4gIGFnZW50UHJvcHM6IExhbmdjaGFpbkFnZW50UHJvcHM7XG4gIFxuICAvKipcbiAgICogT3B0aW9uYWwgc3RhY2sgbmFtZSBwcmVmaXhcbiAgICovXG4gIHN0YWNrTmFtZVByZWZpeD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBTdGFjayB3cmFwcGVyIGZvciB0aGUgTGFuZ2NoYWluQWdlbnQgY29uc3RydWN0XG4gKiBQcm92aWRlcyBhIGNvbXBsZXRlIGRlcGxveW1lbnQgdW5pdCBmb3IgdGhlIGFnZW50XG4gKi9cbmV4cG9ydCBjbGFzcyBMYW5nY2hhaW5BZ2VudFN0YWNrIGV4dGVuZHMgU3RhY2sge1xuICBwdWJsaWMgcmVhZG9ubHkgYWdlbnQ6IExhbmdjaGFpbkFnZW50O1xuICBcbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IExhbmdjaGFpbkFnZW50U3RhY2tQcm9wcykge1xuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xuICAgIFxuICAgIC8vIENyZWF0ZSB0aGUgTGFuZ2NoYWluQWdlbnQgY29uc3RydWN0XG4gICAgdGhpcy5hZ2VudCA9IG5ldyBMYW5nY2hhaW5BZ2VudCh0aGlzLCAnTGFuZ2NoYWluQWdlbnQnLCBwcm9wcy5hZ2VudFByb3BzKTtcbiAgICBcbiAgICAvLyBBZGQgc3RhY2stbGV2ZWwgdGFnc1xuICAgIHRoaXMuYWRkU3RhY2tUYWdzKCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBBZGQgY29tbW9uIHRhZ3MgdG8gdGhlIHN0YWNrXG4gICAqL1xuICBwcml2YXRlIGFkZFN0YWNrVGFncygpOiB2b2lkIHtcbiAgICB0aGlzLnRhZ3Muc2V0VGFnKCdQcm9qZWN0JywgJ0t4R2VuJyk7XG4gICAgdGhpcy50YWdzLnNldFRhZygnQ29tcG9uZW50JywgJ0xhbmdjaGFpbkFnZW50Jyk7XG4gICAgdGhpcy50YWdzLnNldFRhZygnTWFuYWdlZEJ5JywgJ0NESycpO1xuICB9XG59XG5cbi8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGNvbXBsZXRlIExhbmdjaGFpbkFnZW50IHN0YWNrXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMYW5nY2hhaW5BZ2VudFN0YWNrKFxuICBzY29wZTogQ29uc3RydWN0LFxuICBpZDogc3RyaW5nLFxuICBwcm9wczoge1xuICAgIGV2ZW50QnVzQXJuOiBzdHJpbmc7XG4gICAgbWVzc2FnZXNUYWJsZU5hbWU6IHN0cmluZztcbiAgICBsZWFkc1RhYmxlTmFtZTogc3RyaW5nO1xuICAgIGJlZHJvY2tNb2RlbElkPzogc3RyaW5nO1xuICAgIG9wZW5zZWFyY2hDb2xsZWN0aW9uQXJuPzogc3RyaW5nO1xuICAgIHB1dEV2ZW50c1JvbGVBcm4/OiBzdHJpbmc7XG4gICAgZW52Pzoge1xuICAgICAgYWNjb3VudD86IHN0cmluZztcbiAgICAgIHJlZ2lvbj86IHN0cmluZztcbiAgICB9O1xuICB9XG4pOiBMYW5nY2hhaW5BZ2VudFN0YWNrIHtcbiAgcmV0dXJuIG5ldyBMYW5nY2hhaW5BZ2VudFN0YWNrKHNjb3BlLCBpZCwge1xuICAgIGVudjogcHJvcHMuZW52LFxuICAgIGFnZW50UHJvcHM6IHtcbiAgICAgIGV2ZW50QnVzOiBwcm9wcy5ldmVudEJ1c0FybixcbiAgICAgIGV4aXN0aW5nVGFibGVzOiBwcm9wcy5tZXNzYWdlc1RhYmxlTmFtZSAmJiBwcm9wcy5sZWFkc1RhYmxlTmFtZSA/IHtcbiAgICAgICAgbWVzc2FnZXNUYWJsZU5hbWU6IHByb3BzLm1lc3NhZ2VzVGFibGVOYW1lLFxuICAgICAgICBsZWFkc1RhYmxlTmFtZTogcHJvcHMubGVhZHNUYWJsZU5hbWUsXG4gICAgICB9IDogdW5kZWZpbmVkLFxuICAgICAgYmVkcm9ja01vZGVsSWQ6IHByb3BzLmJlZHJvY2tNb2RlbElkIHx8ICdhbnRocm9waWMuY2xhdWRlLTMtc29ubmV0LTIwMjQwMjI5LXYxOjAnLFxuICAgICAgb3BlbnNlYXJjaENvbGxlY3Rpb25Bcm46IHByb3BzLm9wZW5zZWFyY2hDb2xsZWN0aW9uQXJuLFxuICAgICAgcHV0RXZlbnRzUm9sZUFybjogcHJvcHMucHV0RXZlbnRzUm9sZUFybixcbiAgICB9LFxuICB9KTtcbn1cbiJdfQ==