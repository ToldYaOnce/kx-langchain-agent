"use strict";
/**
 * Agent Service Event Schemas
 *
 * These events are emitted by the agent service to communicate
 * workflow state changes, goal progress, and data collection.
 *
 * Event Naming Convention: agent.<entity>.<action>
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.AgentEventFactory = void 0;
/**
 * Helper to create properly structured events
 */
class AgentEventFactory {
    static createGoalActivated(channelId, tenantId, goalId, goalName, goalType, priority, order, activationReason, fieldsToCapture) {
        return {
            channelId,
            tenantId,
            timestamp: new Date().toISOString(),
            version: '1.0',
            goalId,
            goalName,
            goalType,
            priority,
            order,
            fieldsToCapture,
            activationReason: activationReason,
        };
    }
    static createGoalCompleted(channelId, tenantId, goalId, goalName, goalType, capturedData, attemptCount, messagesSinceActivation) {
        return {
            channelId,
            tenantId,
            timestamp: new Date().toISOString(),
            version: '1.0',
            goalId,
            goalName,
            goalType,
            capturedData,
            attemptCount,
            messagesSinceActivation,
        };
    }
    static createDataCaptured(channelId, tenantId, fieldName, fieldValue, goalId, validated = true, validationErrors) {
        return {
            channelId,
            tenantId,
            timestamp: new Date().toISOString(),
            version: '1.0',
            fieldName,
            fieldValue,
            goalId,
            dataType: typeof fieldValue,
            validated,
            validationErrors,
        };
    }
    static createWorkflowStateUpdated(channelId, tenantId, activeGoals, completedGoals, messageCount, capturedData, changes) {
        return {
            channelId,
            tenantId,
            timestamp: new Date().toISOString(),
            version: '1.0',
            activeGoals,
            completedGoals,
            messageCount,
            capturedData,
            contactStatus: {
                isEmailCaptured: !!capturedData.email,
                isPhoneCaptured: !!capturedData.phone,
                isFirstNameCaptured: !!capturedData.firstName,
                isLastNameCaptured: !!capturedData.lastName,
            },
            changes,
        };
    }
    static createLeadCreated(channelId, tenantId, source, leadType, contactInfo, capturedData, completedGoals, messageCount, firstMessageTimestamp) {
        const now = new Date();
        const firstMsg = new Date(firstMessageTimestamp);
        const durationMinutes = Math.floor((now.getTime() - firstMsg.getTime()) / 60000);
        return {
            channelId,
            tenantId,
            timestamp: now.toISOString(),
            version: '1.0',
            leadId: channelId, // channelId = leadId
            source: source,
            leadType,
            contactInfo,
            capturedData,
            completedGoals,
            conversationMetadata: {
                messageCount,
                durationMinutes,
                firstMessageTimestamp,
            },
        };
    }
}
exports.AgentEventFactory = AgentEventFactory;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWdlbnQtZXZlbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3R5cGVzL2FnZW50LWV2ZW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7O0FBcVBIOztHQUVHO0FBQ0gsTUFBYSxpQkFBaUI7SUFDNUIsTUFBTSxDQUFDLG1CQUFtQixDQUN4QixTQUFpQixFQUNqQixRQUFnQixFQUNoQixNQUFjLEVBQ2QsUUFBZ0IsRUFDaEIsUUFBMkQsRUFDM0QsUUFBZ0QsRUFDaEQsS0FBYSxFQUNiLGdCQUFzRCxFQUN0RCxlQUEwQjtRQUUxQixPQUFPO1lBQ0wsU0FBUztZQUNULFFBQVE7WUFDUixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7WUFDbkMsT0FBTyxFQUFFLEtBQUs7WUFDZCxNQUFNO1lBQ04sUUFBUTtZQUNSLFFBQVE7WUFDUixRQUFRO1lBQ1IsS0FBSztZQUNMLGVBQWU7WUFDZixnQkFBZ0IsRUFBRSxnQkFBdUI7U0FDMUMsQ0FBQztJQUNKLENBQUM7SUFFRCxNQUFNLENBQUMsbUJBQW1CLENBQ3hCLFNBQWlCLEVBQ2pCLFFBQWdCLEVBQ2hCLE1BQWMsRUFDZCxRQUFnQixFQUNoQixRQUEyRCxFQUMzRCxZQUFpQyxFQUNqQyxZQUFvQixFQUNwQix1QkFBK0I7UUFFL0IsT0FBTztZQUNMLFNBQVM7WUFDVCxRQUFRO1lBQ1IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1lBQ25DLE9BQU8sRUFBRSxLQUFLO1lBQ2QsTUFBTTtZQUNOLFFBQVE7WUFDUixRQUFRO1lBQ1IsWUFBWTtZQUNaLFlBQVk7WUFDWix1QkFBdUI7U0FDeEIsQ0FBQztJQUNKLENBQUM7SUFFRCxNQUFNLENBQUMsa0JBQWtCLENBQ3ZCLFNBQWlCLEVBQ2pCLFFBQWdCLEVBQ2hCLFNBQWlCLEVBQ2pCLFVBQWUsRUFDZixNQUFjLEVBQ2QsWUFBcUIsSUFBSSxFQUN6QixnQkFBMkI7UUFFM0IsT0FBTztZQUNMLFNBQVM7WUFDVCxRQUFRO1lBQ1IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1lBQ25DLE9BQU8sRUFBRSxLQUFLO1lBQ2QsU0FBUztZQUNULFVBQVU7WUFDVixNQUFNO1lBQ04sUUFBUSxFQUFFLE9BQU8sVUFBaUI7WUFDbEMsU0FBUztZQUNULGdCQUFnQjtTQUNqQixDQUFDO0lBQ0osQ0FBQztJQUVELE1BQU0sQ0FBQywwQkFBMEIsQ0FDL0IsU0FBaUIsRUFDakIsUUFBZ0IsRUFDaEIsV0FBcUIsRUFDckIsY0FBd0IsRUFDeEIsWUFBb0IsRUFDcEIsWUFBaUMsRUFDakMsT0FJQztRQUVELE9BQU87WUFDTCxTQUFTO1lBQ1QsUUFBUTtZQUNSLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtZQUNuQyxPQUFPLEVBQUUsS0FBSztZQUNkLFdBQVc7WUFDWCxjQUFjO1lBQ2QsWUFBWTtZQUNaLFlBQVk7WUFDWixhQUFhLEVBQUU7Z0JBQ2IsZUFBZSxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsS0FBSztnQkFDckMsZUFBZSxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsS0FBSztnQkFDckMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxTQUFTO2dCQUM3QyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsWUFBWSxDQUFDLFFBQVE7YUFDNUM7WUFDRCxPQUFPO1NBQ1IsQ0FBQztJQUNKLENBQUM7SUFFRCxNQUFNLENBQUMsaUJBQWlCLENBQ3RCLFNBQWlCLEVBQ2pCLFFBQWdCLEVBQ2hCLE1BQWMsRUFDZCxRQUFnQixFQUNoQixXQUFzRixFQUN0RixZQUFpQyxFQUNqQyxjQUF3QixFQUN4QixZQUFvQixFQUNwQixxQkFBNkI7UUFFN0IsTUFBTSxHQUFHLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUN2QixNQUFNLFFBQVEsR0FBRyxJQUFJLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ2pELE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEdBQUcsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUM7UUFFakYsT0FBTztZQUNMLFNBQVM7WUFDVCxRQUFRO1lBQ1IsU0FBUyxFQUFFLEdBQUcsQ0FBQyxXQUFXLEVBQUU7WUFDNUIsT0FBTyxFQUFFLEtBQUs7WUFDZCxNQUFNLEVBQUUsU0FBUyxFQUFFLHFCQUFxQjtZQUN4QyxNQUFNLEVBQUUsTUFBYTtZQUNyQixRQUFRO1lBQ1IsV0FBVztZQUNYLFlBQVk7WUFDWixjQUFjO1lBQ2Qsb0JBQW9CLEVBQUU7Z0JBQ3BCLFlBQVk7Z0JBQ1osZUFBZTtnQkFDZixxQkFBcUI7YUFDdEI7U0FDRixDQUFDO0lBQ0osQ0FBQztDQUNGO0FBM0lELDhDQTJJQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBBZ2VudCBTZXJ2aWNlIEV2ZW50IFNjaGVtYXNcclxuICogXHJcbiAqIFRoZXNlIGV2ZW50cyBhcmUgZW1pdHRlZCBieSB0aGUgYWdlbnQgc2VydmljZSB0byBjb21tdW5pY2F0ZVxyXG4gKiB3b3JrZmxvdyBzdGF0ZSBjaGFuZ2VzLCBnb2FsIHByb2dyZXNzLCBhbmQgZGF0YSBjb2xsZWN0aW9uLlxyXG4gKiBcclxuICogRXZlbnQgTmFtaW5nIENvbnZlbnRpb246IGFnZW50LjxlbnRpdHk+LjxhY3Rpb24+XHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEJhc2UgZXZlbnQgc3RydWN0dXJlIC0gYWxsIGFnZW50IGV2ZW50cyBleHRlbmQgdGhpc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBBZ2VudEV2ZW50QmFzZSB7XHJcbiAgLyoqIENoYW5uZWwgSUQgKGFsc28gdXNlZCBhcyBsZWFkIElEIHdoZW4gbGVhZCBpcyBjcmVhdGVkKSAqL1xyXG4gIGNoYW5uZWxJZDogc3RyaW5nO1xyXG4gIC8qKiBUZW5hbnQgSUQgKi9cclxuICB0ZW5hbnRJZDogc3RyaW5nO1xyXG4gIC8qKiBJU08gdGltZXN0YW1wICovXHJcbiAgdGltZXN0YW1wOiBzdHJpbmc7XHJcbiAgLyoqIEV2ZW50IHZlcnNpb24gZm9yIHNjaGVtYSBldm9sdXRpb24gKi9cclxuICB2ZXJzaW9uOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWl0dGVkIHdoZW4gYSBnb2FsIGlzIGFjdGl2YXRlZFxyXG4gKiBFdmVudEJyaWRnZTogYWdlbnQuZ29hbC5hY3RpdmF0ZWRcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgR29hbEFjdGl2YXRlZEV2ZW50IGV4dGVuZHMgQWdlbnRFdmVudEJhc2Uge1xyXG4gIC8qKiBVbmlxdWUgZ29hbCBJRCAqL1xyXG4gIGdvYWxJZDogc3RyaW5nO1xyXG4gIC8qKiBIdW1hbi1yZWFkYWJsZSBnb2FsIG5hbWUgKi9cclxuICBnb2FsTmFtZTogc3RyaW5nO1xyXG4gIC8qKiBHb2FsIHR5cGUgKi9cclxuICBnb2FsVHlwZTogJ2RhdGFfY29sbGVjdGlvbicgfCAnc2NoZWR1bGluZycgfCAnY29udmVyc2F0aW9uJztcclxuICAvKiogR29hbCBwcmlvcml0eSAqL1xyXG4gIHByaW9yaXR5OiAnY3JpdGljYWwnIHwgJ2hpZ2gnIHwgJ21lZGl1bScgfCAnbG93JztcclxuICAvKiogR29hbCBvcmRlciBpbiB3b3JrZmxvdyAqL1xyXG4gIG9yZGVyOiBudW1iZXI7XHJcbiAgLyoqIFdoYXQgZGF0YSBmaWVsZHMgdGhpcyBnb2FsIHdpbGwgY29sbGVjdCAoaWYgZGF0YV9jb2xsZWN0aW9uIHR5cGUpICovXHJcbiAgZmllbGRzVG9DYXB0dXJlPzogc3RyaW5nW107XHJcbiAgLyoqIFdoeSB0aGlzIGdvYWwgd2FzIGFjdGl2YXRlZCAqL1xyXG4gIGFjdGl2YXRpb25SZWFzb246IHtcclxuICAgIC8qKiBXaGljaCB0cmlnZ2VyIGNhdXNlZCBhY3RpdmF0aW9uICovXHJcbiAgICB0cmlnZ2VyOiAnbWVzc2FnZUNvdW50JyB8ICdhZnRlckdvYWxzJyB8ICd1c2VyU2lnbmFscyc7XHJcbiAgICAvKiogRGV0YWlscyBhYm91dCB0aGUgdHJpZ2dlciAqL1xyXG4gICAgZGV0YWlsczogc3RyaW5nO1xyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWl0dGVkIHdoZW4gYSBnb2FsIGlzIGNvbXBsZXRlZFxyXG4gKiBFdmVudEJyaWRnZTogYWdlbnQuZ29hbC5jb21wbGV0ZWRcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgR29hbENvbXBsZXRlZEV2ZW50IGV4dGVuZHMgQWdlbnRFdmVudEJhc2Uge1xyXG4gIC8qKiBVbmlxdWUgZ29hbCBJRCAqL1xyXG4gIGdvYWxJZDogc3RyaW5nO1xyXG4gIC8qKiBIdW1hbi1yZWFkYWJsZSBnb2FsIG5hbWUgKi9cclxuICBnb2FsTmFtZTogc3RyaW5nO1xyXG4gIC8qKiBHb2FsIHR5cGUgKi9cclxuICBnb2FsVHlwZTogJ2RhdGFfY29sbGVjdGlvbicgfCAnc2NoZWR1bGluZycgfCAnY29udmVyc2F0aW9uJztcclxuICAvKiogRGF0YSBjYXB0dXJlZCBkdXJpbmcgdGhpcyBnb2FsICovXHJcbiAgY2FwdHVyZWREYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIC8qKiBIb3cgbWFueSBhdHRlbXB0cyBpdCB0b29rIHRvIGNvbXBsZXRlICovXHJcbiAgYXR0ZW1wdENvdW50OiBudW1iZXI7XHJcbiAgLyoqIEhvdyBtYW55IG1lc3NhZ2VzIHNpbmNlIGdvYWwgYWN0aXZhdGlvbiAqL1xyXG4gIG1lc3NhZ2VzU2luY2VBY3RpdmF0aW9uOiBudW1iZXI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWl0dGVkIHdoZW4gYW55IGRhdGEgZmllbGQgaXMgY2FwdHVyZWRcclxuICogRXZlbnRCcmlkZ2U6IGFnZW50LmRhdGEuY2FwdHVyZWRcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGF0YUNhcHR1cmVkRXZlbnQgZXh0ZW5kcyBBZ2VudEV2ZW50QmFzZSB7XHJcbiAgLyoqIFRoZSBmaWVsZCBuYW1lIHRoYXQgd2FzIGNhcHR1cmVkICovXHJcbiAgZmllbGROYW1lOiBzdHJpbmc7XHJcbiAgLyoqIFRoZSBjYXB0dXJlZCB2YWx1ZSAqL1xyXG4gIGZpZWxkVmFsdWU6IGFueTtcclxuICAvKiogV2hpY2ggZ29hbCB0aGlzIGRhdGEgYmVsb25ncyB0byAqL1xyXG4gIGdvYWxJZDogc3RyaW5nO1xyXG4gIC8qKiBEYXRhIHR5cGUgKi9cclxuICBkYXRhVHlwZTogJ3N0cmluZycgfCAnbnVtYmVyJyB8ICdib29sZWFuJyB8ICdvYmplY3QnIHwgJ2FycmF5JztcclxuICAvKiogVmFsaWRhdGlvbiBzdGF0dXMgKi9cclxuICB2YWxpZGF0ZWQ6IGJvb2xlYW47XHJcbiAgLyoqIFZhbGlkYXRpb24gZXJyb3JzIGlmIGFueSAqL1xyXG4gIHZhbGlkYXRpb25FcnJvcnM/OiBzdHJpbmdbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVtaXR0ZWQgd2hlbiB3b3JrZmxvdyBzdGF0ZSBpcyB1cGRhdGVkXHJcbiAqIEV2ZW50QnJpZGdlOiBhZ2VudC53b3JrZmxvdy5zdGF0ZV91cGRhdGVkXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtmbG93U3RhdGVVcGRhdGVkRXZlbnQgZXh0ZW5kcyBBZ2VudEV2ZW50QmFzZSB7XHJcbiAgLyoqIEN1cnJlbnRseSBhY3RpdmUgZ29hbHMgKi9cclxuICBhY3RpdmVHb2Fsczogc3RyaW5nW107XHJcbiAgLyoqIENvbXBsZXRlZCBnb2FscyAqL1xyXG4gIGNvbXBsZXRlZEdvYWxzOiBzdHJpbmdbXTtcclxuICAvKiogVG90YWwgbWVzc2FnZXMgaW4gY29udmVyc2F0aW9uICovXHJcbiAgbWVzc2FnZUNvdW50OiBudW1iZXI7XHJcbiAgLyoqIEFsbCBjYXB0dXJlZCBkYXRhIHNvIGZhciAqL1xyXG4gIGNhcHR1cmVkRGF0YTogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICAvKiogQ29udGFjdCBpbmZvIGNhcHR1cmUgc3RhdHVzICovXHJcbiAgY29udGFjdFN0YXR1czoge1xyXG4gICAgaXNFbWFpbENhcHR1cmVkOiBib29sZWFuO1xyXG4gICAgaXNQaG9uZUNhcHR1cmVkOiBib29sZWFuO1xyXG4gICAgaXNGaXJzdE5hbWVDYXB0dXJlZDogYm9vbGVhbjtcclxuICAgIGlzTGFzdE5hbWVDYXB0dXJlZDogYm9vbGVhbjtcclxuICB9O1xyXG4gIC8qKiBXaGF0IGNoYW5nZWQgaW4gdGhpcyB1cGRhdGUgKi9cclxuICBjaGFuZ2VzOiB7XHJcbiAgICBnb2Fsc0FjdGl2YXRlZDogc3RyaW5nW107XHJcbiAgICBnb2Fsc0NvbXBsZXRlZDogc3RyaW5nW107XHJcbiAgICBkYXRhQ2FwdHVyZWQ6IHN0cmluZ1tdO1xyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWl0dGVkIHdoZW4gYSBsZWFkIGlzIGNyZWF0ZWQgZnJvbSBhbm9ueW1vdXMgY2hhbm5lbFxyXG4gKiBFdmVudEJyaWRnZTogbGVhZC5jcmVhdGVkXHJcbiAqIFxyXG4gKiBOb3RlOiBUaGlzIGlzIHRyaWdnZXJlZCBieSBnb2FsIGNvbXBsZXRpb24gd2l0aCBhY3Rpb24gdHlwZSBcImNvbnZlcnRfYW5vbnltb3VzX3RvX2xlYWRcIlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBMZWFkQ3JlYXRlZEV2ZW50IGV4dGVuZHMgQWdlbnRFdmVudEJhc2Uge1xyXG4gIC8qKiBMZWFkIElEIChzYW1lIGFzIGNoYW5uZWxJZCkgKi9cclxuICBsZWFkSWQ6IHN0cmluZztcclxuICAvKiogU291cmNlIG9mIGxlYWQgKi9cclxuICBzb3VyY2U6ICdjaGF0X2FnZW50JyB8ICd3ZWJfZm9ybScgfCAncGhvbmUnIHwgJ290aGVyJztcclxuICAvKiogTGVhZCB0eXBlIGZvciBzZWdtZW50YXRpb24gKi9cclxuICBsZWFkVHlwZTogc3RyaW5nO1xyXG4gIC8qKiBDb250YWN0IGluZm9ybWF0aW9uICovXHJcbiAgY29udGFjdEluZm86IHtcclxuICAgIGZpcnN0TmFtZT86IHN0cmluZztcclxuICAgIGxhc3ROYW1lPzogc3RyaW5nO1xyXG4gICAgZW1haWw/OiBzdHJpbmc7XHJcbiAgICBwaG9uZT86IHN0cmluZztcclxuICB9O1xyXG4gIC8qKiBBbGwgY2FwdHVyZWQgZGF0YSBmcm9tIHdvcmtmbG93ICovXHJcbiAgY2FwdHVyZWREYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xyXG4gIC8qKiBXaGljaCBnb2FscyB3ZXJlIGNvbXBsZXRlZCB3aGVuIGxlYWQgd2FzIGNyZWF0ZWQgKi9cclxuICBjb21wbGV0ZWRHb2Fsczogc3RyaW5nW107XHJcbiAgLyoqIENvbnZlcnNhdGlvbiBtZXRhZGF0YSAqL1xyXG4gIGNvbnZlcnNhdGlvbk1ldGFkYXRhOiB7XHJcbiAgICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcclxuICAgIGR1cmF0aW9uTWludXRlczogbnVtYmVyO1xyXG4gICAgZmlyc3RNZXNzYWdlVGltZXN0YW1wOiBzdHJpbmc7XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVtaXR0ZWQgd2hlbiBhbiBhcHBvaW50bWVudCBpcyByZXF1ZXN0ZWRcclxuICogRXZlbnRCcmlkZ2U6IGFwcG9pbnRtZW50LnJlcXVlc3RlZFxyXG4gKiBcclxuICogTm90ZTogVGhpcyBpcyB0cmlnZ2VyZWQgYnkgZ29hbCBjb21wbGV0aW9uIHdpdGggYWN0aW9uIHR5cGUgXCJ0cmlnZ2VyX3NjaGVkdWxpbmdfZmxvd1wiXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEFwcG9pbnRtZW50UmVxdWVzdGVkRXZlbnQgZXh0ZW5kcyBBZ2VudEV2ZW50QmFzZSB7XHJcbiAgLyoqIExlYWQgSUQgKGlmIGxlYWQgZXhpc3RzKSAqL1xyXG4gIGxlYWRJZD86IHN0cmluZztcclxuICAvKiogVHlwZSBvZiBhcHBvaW50bWVudCAqL1xyXG4gIGFwcG9pbnRtZW50VHlwZTogc3RyaW5nO1xyXG4gIC8qKiBSZXF1ZXN0ZWQgZGF0ZSAqL1xyXG4gIHJlcXVlc3RlZERhdGU/OiBzdHJpbmc7XHJcbiAgLyoqIFJlcXVlc3RlZCB0aW1lICovXHJcbiAgcmVxdWVzdGVkVGltZT86IHN0cmluZztcclxuICAvKiogRHVyYXRpb24gaW4gbWludXRlcyAqL1xyXG4gIGR1cmF0aW9uPzogbnVtYmVyO1xyXG4gIC8qKiBBZGRpdGlvbmFsIGFwcG9pbnRtZW50IGRldGFpbHMgKi9cclxuICBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgYW55PjtcclxuICAvKiogV2hpY2ggZ29hbCB0cmlnZ2VyZWQgdGhpcyAqL1xyXG4gIGdvYWxJZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogRW1pdHRlZCB3aGVuIHVzZXIgc2hvd3MgaW50ZXJlc3QgaW4gc29tZXRoaW5nXHJcbiAqIEV2ZW50QnJpZGdlOiBhZ2VudC5pbnRlcmVzdC5kZXRlY3RlZFxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJbnRlcmVzdERldGVjdGVkRXZlbnQgZXh0ZW5kcyBBZ2VudEV2ZW50QmFzZSB7XHJcbiAgLyoqIExlYWQgSUQgKGlmIGxlYWQgZXhpc3RzKSAqL1xyXG4gIGxlYWRJZD86IHN0cmluZztcclxuICAvKiogV2hhdCB0aGV5J3JlIGludGVyZXN0ZWQgaW4gKi9cclxuICBpbnRlcmVzdENhdGVnb3J5OiBzdHJpbmc7XHJcbiAgLyoqIFN0cmVuZ3RoIG9mIGludGVyZXN0IHNpZ25hbCAqL1xyXG4gIHN0cmVuZ3RoOiAnd2VhaycgfCAnbWVkaXVtJyB8ICdzdHJvbmcnO1xyXG4gIC8qKiBXaGF0IHRyaWdnZXJlZCB0aGUgaW50ZXJlc3QgZGV0ZWN0aW9uICovXHJcbiAgc2lnbmFsOiB7XHJcbiAgICB0eXBlOiAna2V5d29yZCcgfCAncXVlc3Rpb24nIHwgJ3JlcXVlc3QnIHwgJ3JlcGV0aXRpb24nO1xyXG4gICAgdmFsdWU6IHN0cmluZztcclxuICB9O1xyXG4gIC8qKiBDb250ZXh0IGZyb20gdGhlIG1lc3NhZ2UgKi9cclxuICBjb250ZXh0OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWl0dGVkIHdoZW4gdXNlciBkZWNsaW5lcyBvciBzaG93cyBuZWdhdGl2ZSBzZW50aW1lbnRcclxuICogRXZlbnRCcmlkZ2U6IGFnZW50Lm9iamVjdGlvbi5kZXRlY3RlZFxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBPYmplY3Rpb25EZXRlY3RlZEV2ZW50IGV4dGVuZHMgQWdlbnRFdmVudEJhc2Uge1xyXG4gIC8qKiBMZWFkIElEIChpZiBsZWFkIGV4aXN0cykgKi9cclxuICBsZWFkSWQ/OiBzdHJpbmc7XHJcbiAgLyoqIFR5cGUgb2Ygb2JqZWN0aW9uICovXHJcbiAgb2JqZWN0aW9uVHlwZTogJ3ByaWNlJyB8ICd0aW1lJyB8ICdpbnRlcmVzdCcgfCAnb3RoZXInO1xyXG4gIC8qKiBUaGUgYWN0dWFsIG9iamVjdGlvbiB0ZXh0ICovXHJcbiAgb2JqZWN0aW9uVGV4dDogc3RyaW5nO1xyXG4gIC8qKiBXaGljaCBnb2FsIHdhcyBhY3RpdmUgd2hlbiBvYmplY3Rpb24gb2NjdXJyZWQgKi9cclxuICBnb2FsSWQ/OiBzdHJpbmc7XHJcbiAgLyoqIFNldmVyaXR5ICovXHJcbiAgc2V2ZXJpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFbWl0dGVkIHdoZW4gd29ya2Zsb3cgZW5jb3VudGVycyBhbiBlcnJvclxyXG4gKiBFdmVudEJyaWRnZTogYWdlbnQud29ya2Zsb3cuZXJyb3JcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgV29ya2Zsb3dFcnJvckV2ZW50IGV4dGVuZHMgQWdlbnRFdmVudEJhc2Uge1xyXG4gIC8qKiBFcnJvciB0eXBlICovXHJcbiAgZXJyb3JUeXBlOiAnZGF0YV9leHRyYWN0aW9uJyB8ICdnb2FsX29yY2hlc3RyYXRpb24nIHwgJ2xsbV9mYWlsdXJlJyB8ICdzeXN0ZW0nO1xyXG4gIC8qKiBFcnJvciBtZXNzYWdlICovXHJcbiAgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XHJcbiAgLyoqIFdoaWNoIGdvYWwgd2FzIGFjdGl2ZSAqL1xyXG4gIGFjdGl2ZUdvYWxJZD86IHN0cmluZztcclxuICAvKiogU3RhY2sgdHJhY2UgKGZvciBkZWJ1Z2dpbmcpICovXHJcbiAgc3RhY2tUcmFjZT86IHN0cmluZztcclxuICAvKiogSXMgdGhpcyByZWNvdmVyYWJsZT8gKi9cclxuICByZWNvdmVyYWJsZTogYm9vbGVhbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVuaW9uIHR5cGUgb2YgYWxsIGFnZW50IGV2ZW50c1xyXG4gKi9cclxuZXhwb3J0IHR5cGUgQWdlbnRFdmVudCA9XHJcbiAgfCBHb2FsQWN0aXZhdGVkRXZlbnRcclxuICB8IEdvYWxDb21wbGV0ZWRFdmVudFxyXG4gIHwgRGF0YUNhcHR1cmVkRXZlbnRcclxuICB8IFdvcmtmbG93U3RhdGVVcGRhdGVkRXZlbnRcclxuICB8IExlYWRDcmVhdGVkRXZlbnRcclxuICB8IEFwcG9pbnRtZW50UmVxdWVzdGVkRXZlbnRcclxuICB8IEludGVyZXN0RGV0ZWN0ZWRFdmVudFxyXG4gIHwgT2JqZWN0aW9uRGV0ZWN0ZWRFdmVudFxyXG4gIHwgV29ya2Zsb3dFcnJvckV2ZW50O1xyXG5cclxuLyoqXHJcbiAqIEV2ZW50IHR5cGUgZGlzY3JpbWluYXRvclxyXG4gKi9cclxuZXhwb3J0IHR5cGUgQWdlbnRFdmVudFR5cGUgPVxyXG4gIHwgJ2FnZW50LmdvYWwuYWN0aXZhdGVkJ1xyXG4gIHwgJ2FnZW50LmdvYWwuY29tcGxldGVkJ1xyXG4gIHwgJ2FnZW50LmRhdGEuY2FwdHVyZWQnXHJcbiAgfCAnYWdlbnQud29ya2Zsb3cuc3RhdGVfdXBkYXRlZCdcclxuICB8ICdsZWFkLmNyZWF0ZWQnXHJcbiAgfCAnYXBwb2ludG1lbnQucmVxdWVzdGVkJ1xyXG4gIHwgJ2FnZW50LmludGVyZXN0LmRldGVjdGVkJ1xyXG4gIHwgJ2FnZW50Lm9iamVjdGlvbi5kZXRlY3RlZCdcclxuICB8ICdhZ2VudC53b3JrZmxvdy5lcnJvcic7XHJcblxyXG4vKipcclxuICogSGVscGVyIHRvIGNyZWF0ZSBwcm9wZXJseSBzdHJ1Y3R1cmVkIGV2ZW50c1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFnZW50RXZlbnRGYWN0b3J5IHtcclxuICBzdGF0aWMgY3JlYXRlR29hbEFjdGl2YXRlZChcclxuICAgIGNoYW5uZWxJZDogc3RyaW5nLFxyXG4gICAgdGVuYW50SWQ6IHN0cmluZyxcclxuICAgIGdvYWxJZDogc3RyaW5nLFxyXG4gICAgZ29hbE5hbWU6IHN0cmluZyxcclxuICAgIGdvYWxUeXBlOiAnZGF0YV9jb2xsZWN0aW9uJyB8ICdzY2hlZHVsaW5nJyB8ICdjb252ZXJzYXRpb24nLFxyXG4gICAgcHJpb3JpdHk6ICdjcml0aWNhbCcgfCAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnLFxyXG4gICAgb3JkZXI6IG51bWJlcixcclxuICAgIGFjdGl2YXRpb25SZWFzb246IHsgdHJpZ2dlcjogc3RyaW5nOyBkZXRhaWxzOiBzdHJpbmcgfSxcclxuICAgIGZpZWxkc1RvQ2FwdHVyZT86IHN0cmluZ1tdXHJcbiAgKTogR29hbEFjdGl2YXRlZEV2ZW50IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNoYW5uZWxJZCxcclxuICAgICAgdGVuYW50SWQsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB2ZXJzaW9uOiAnMS4wJyxcclxuICAgICAgZ29hbElkLFxyXG4gICAgICBnb2FsTmFtZSxcclxuICAgICAgZ29hbFR5cGUsXHJcbiAgICAgIHByaW9yaXR5LFxyXG4gICAgICBvcmRlcixcclxuICAgICAgZmllbGRzVG9DYXB0dXJlLFxyXG4gICAgICBhY3RpdmF0aW9uUmVhc29uOiBhY3RpdmF0aW9uUmVhc29uIGFzIGFueSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgY3JlYXRlR29hbENvbXBsZXRlZChcclxuICAgIGNoYW5uZWxJZDogc3RyaW5nLFxyXG4gICAgdGVuYW50SWQ6IHN0cmluZyxcclxuICAgIGdvYWxJZDogc3RyaW5nLFxyXG4gICAgZ29hbE5hbWU6IHN0cmluZyxcclxuICAgIGdvYWxUeXBlOiAnZGF0YV9jb2xsZWN0aW9uJyB8ICdzY2hlZHVsaW5nJyB8ICdjb252ZXJzYXRpb24nLFxyXG4gICAgY2FwdHVyZWREYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxyXG4gICAgYXR0ZW1wdENvdW50OiBudW1iZXIsXHJcbiAgICBtZXNzYWdlc1NpbmNlQWN0aXZhdGlvbjogbnVtYmVyXHJcbiAgKTogR29hbENvbXBsZXRlZEV2ZW50IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNoYW5uZWxJZCxcclxuICAgICAgdGVuYW50SWQsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB2ZXJzaW9uOiAnMS4wJyxcclxuICAgICAgZ29hbElkLFxyXG4gICAgICBnb2FsTmFtZSxcclxuICAgICAgZ29hbFR5cGUsXHJcbiAgICAgIGNhcHR1cmVkRGF0YSxcclxuICAgICAgYXR0ZW1wdENvdW50LFxyXG4gICAgICBtZXNzYWdlc1NpbmNlQWN0aXZhdGlvbixcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgY3JlYXRlRGF0YUNhcHR1cmVkKFxyXG4gICAgY2hhbm5lbElkOiBzdHJpbmcsXHJcbiAgICB0ZW5hbnRJZDogc3RyaW5nLFxyXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXHJcbiAgICBmaWVsZFZhbHVlOiBhbnksXHJcbiAgICBnb2FsSWQ6IHN0cmluZyxcclxuICAgIHZhbGlkYXRlZDogYm9vbGVhbiA9IHRydWUsXHJcbiAgICB2YWxpZGF0aW9uRXJyb3JzPzogc3RyaW5nW11cclxuICApOiBEYXRhQ2FwdHVyZWRFdmVudCB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjaGFubmVsSWQsXHJcbiAgICAgIHRlbmFudElkLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgdmVyc2lvbjogJzEuMCcsXHJcbiAgICAgIGZpZWxkTmFtZSxcclxuICAgICAgZmllbGRWYWx1ZSxcclxuICAgICAgZ29hbElkLFxyXG4gICAgICBkYXRhVHlwZTogdHlwZW9mIGZpZWxkVmFsdWUgYXMgYW55LFxyXG4gICAgICB2YWxpZGF0ZWQsXHJcbiAgICAgIHZhbGlkYXRpb25FcnJvcnMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIGNyZWF0ZVdvcmtmbG93U3RhdGVVcGRhdGVkKFxyXG4gICAgY2hhbm5lbElkOiBzdHJpbmcsXHJcbiAgICB0ZW5hbnRJZDogc3RyaW5nLFxyXG4gICAgYWN0aXZlR29hbHM6IHN0cmluZ1tdLFxyXG4gICAgY29tcGxldGVkR29hbHM6IHN0cmluZ1tdLFxyXG4gICAgbWVzc2FnZUNvdW50OiBudW1iZXIsXHJcbiAgICBjYXB0dXJlZERhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4sXHJcbiAgICBjaGFuZ2VzOiB7XHJcbiAgICAgIGdvYWxzQWN0aXZhdGVkOiBzdHJpbmdbXTtcclxuICAgICAgZ29hbHNDb21wbGV0ZWQ6IHN0cmluZ1tdO1xyXG4gICAgICBkYXRhQ2FwdHVyZWQ6IHN0cmluZ1tdO1xyXG4gICAgfVxyXG4gICk6IFdvcmtmbG93U3RhdGVVcGRhdGVkRXZlbnQge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY2hhbm5lbElkLFxyXG4gICAgICB0ZW5hbnRJZCxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHZlcnNpb246ICcxLjAnLFxyXG4gICAgICBhY3RpdmVHb2FscyxcclxuICAgICAgY29tcGxldGVkR29hbHMsXHJcbiAgICAgIG1lc3NhZ2VDb3VudCxcclxuICAgICAgY2FwdHVyZWREYXRhLFxyXG4gICAgICBjb250YWN0U3RhdHVzOiB7XHJcbiAgICAgICAgaXNFbWFpbENhcHR1cmVkOiAhIWNhcHR1cmVkRGF0YS5lbWFpbCxcclxuICAgICAgICBpc1Bob25lQ2FwdHVyZWQ6ICEhY2FwdHVyZWREYXRhLnBob25lLFxyXG4gICAgICAgIGlzRmlyc3ROYW1lQ2FwdHVyZWQ6ICEhY2FwdHVyZWREYXRhLmZpcnN0TmFtZSxcclxuICAgICAgICBpc0xhc3ROYW1lQ2FwdHVyZWQ6ICEhY2FwdHVyZWREYXRhLmxhc3ROYW1lLFxyXG4gICAgICB9LFxyXG4gICAgICBjaGFuZ2VzLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBjcmVhdGVMZWFkQ3JlYXRlZChcclxuICAgIGNoYW5uZWxJZDogc3RyaW5nLFxyXG4gICAgdGVuYW50SWQ6IHN0cmluZyxcclxuICAgIHNvdXJjZTogc3RyaW5nLFxyXG4gICAgbGVhZFR5cGU6IHN0cmluZyxcclxuICAgIGNvbnRhY3RJbmZvOiB7IGZpcnN0TmFtZT86IHN0cmluZzsgbGFzdE5hbWU/OiBzdHJpbmc7IGVtYWlsPzogc3RyaW5nOyBwaG9uZT86IHN0cmluZyB9LFxyXG4gICAgY2FwdHVyZWREYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LFxyXG4gICAgY29tcGxldGVkR29hbHM6IHN0cmluZ1tdLFxyXG4gICAgbWVzc2FnZUNvdW50OiBudW1iZXIsXHJcbiAgICBmaXJzdE1lc3NhZ2VUaW1lc3RhbXA6IHN0cmluZ1xyXG4gICk6IExlYWRDcmVhdGVkRXZlbnQge1xyXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuICAgIGNvbnN0IGZpcnN0TXNnID0gbmV3IERhdGUoZmlyc3RNZXNzYWdlVGltZXN0YW1wKTtcclxuICAgIGNvbnN0IGR1cmF0aW9uTWludXRlcyA9IE1hdGguZmxvb3IoKG5vdy5nZXRUaW1lKCkgLSBmaXJzdE1zZy5nZXRUaW1lKCkpIC8gNjAwMDApO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNoYW5uZWxJZCxcclxuICAgICAgdGVuYW50SWQsXHJcbiAgICAgIHRpbWVzdGFtcDogbm93LnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIHZlcnNpb246ICcxLjAnLFxyXG4gICAgICBsZWFkSWQ6IGNoYW5uZWxJZCwgLy8gY2hhbm5lbElkID0gbGVhZElkXHJcbiAgICAgIHNvdXJjZTogc291cmNlIGFzIGFueSxcclxuICAgICAgbGVhZFR5cGUsXHJcbiAgICAgIGNvbnRhY3RJbmZvLFxyXG4gICAgICBjYXB0dXJlZERhdGEsXHJcbiAgICAgIGNvbXBsZXRlZEdvYWxzLFxyXG4gICAgICBjb252ZXJzYXRpb25NZXRhZGF0YToge1xyXG4gICAgICAgIG1lc3NhZ2VDb3VudCxcclxuICAgICAgICBkdXJhdGlvbk1pbnV0ZXMsXHJcbiAgICAgICAgZmlyc3RNZXNzYWdlVGltZXN0YW1wLFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcblxyXG4iXX0=